#include "sandbox.h"

void parse_object(char object, int x, int y) {
	if (object != '2') {
		if (object == 'N') {
			player.rotation_angle = M_PI / 2;
		} else if (object == 'E') {
			player.rotation_angle = 0.2 * M_PI;
		} else if (object == 'S') {
			player.rotation_angle = (3 * M_PI) / 2;
		} else if (object == 'W') {
			player.rotation_angle = M_PI;
		} else {
			exit(0);
		}
		player.x = x * TILE_SIZE + (double)TILE_SIZE / 2;
		player.y = y * TILE_SIZE + (double)TILE_SIZE / 2;
	}
}

void init_map()
{
	char map[MAP_Y][MAP_X] = {
		{'1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'},
		{'1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1'},
		{'1', '0', '1', '1', '0', '0', '0', '0', '0', '1', '1', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1'},
		{'1', '0', '0', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', 'S', '1', '0', '0', '0', '0', '0', '0', '1'},
		{'1', '0', '1', '1', '0', '0', '0', '0', '0', '1', '1', '1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1'},
		{'1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0', '0', '0', '0', '1', '1', '0', '0', '0', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '1', '1', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '0', '1', '1', '1', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '1', '1', '1', '0', '1', '1', '1', '1', '1', '1', '1', '1', '1', '0', '1', '1', '1', '0', '1', '0', '1', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '1', '0', '0', '0', '0', '0', '0', '1', '1', '0', '1', '0', '1', '0', '1', '1', '1', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '0', '0', '0', '2', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '0', '0', '0', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '0', '1', '1', '0', '1', '0', '1', '0', '0', '1', '0', '0', '0', '1'},
		{'1', '1', '0', '0', '0', '0', '0', '0', '1', '1', '0', '1', '0', '1', '0', '1', '1', '1', '1', '1', '0', '1', '1', '1', '1', '0', '0', '0', '1'},
		{'1', '1', '1', '1', '0', '1', '1', '1', '1', '1', '1', '1', '0', '1', '0', '1', '1', '1', '1', '1', '0', '1', '1', '1', '1', '0', '0', '0', '1'},
		{'1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1', '1'},
	};
	char **actual_map;

	actual_map = malloc(MAP_Y * sizeof(*actual_map));
	for (size_t i = 0; i < MAP_Y; i++)
	{
		actual_map[i] = malloc(MAP_X * sizeof(**actual_map));
		for (size_t j = 0; j < MAP_X; j++)
		{
			(void)actual_map[i][j];
			(void)map[i][j];
			actual_map[i][j] = map[i][j];
			printf("%c ", actual_map[i][j]);
			if (actual_map[i][j] != '1' && actual_map[i][j] != '0')
				parse_object(actual_map[i][j], j, i);
		}
		printf("\n");
	}
	player.map = actual_map;
}
